### 1.OSI,TCP/IP,五层协议的体系结构

> OSI分层（7层） ：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。

> TCP/IP分层（4层） ：网络接口层、网际层、运输层、应用层。

> 五层协议（5层） ：物理层、数据链路层、网络层、运输层、应用层。

每一层的作用如下:

物理层：

        物理层考虑的是怎样才能连接在各种计算机的传输媒体上传输数据比特流，而不是指具体的传输媒体。激活、维持、关闭通信端点之间的机械特性、电气特性、功能特性以及过程特性。该层为上层协议提供了一个传输数据的物理媒体。
        
数据链路层：

        数据链路层在不可靠的物理介质上提供可靠的传输。该层的作用包括：封装成帧、透明传输、差错检测。

网络层 ：网络层负责对子网间的数据包进行路由选择。此外，网络层还可以实现拥塞控制、网际互连等功能。

传输层 ：第一个端到端，即主机到主机的层次。传输层负责将上层数据分段并提供端到端的、可靠的或不可靠的传输。此外，传输层还要处理端到端的差错控制和流量控制问题。

会话层 ：会话层管理主机之间的会话进程，即负责建立、管理、终止进程之间的会话。会话层还利用在数据中插入校验点来实现数据的同步。

表示层 ：表示层对上层数据或信息进行变换以保证一个主机应用层信息可以被另一个主机的应用程序理解。表示层的数据转换包括数据的加密、压缩、格式转换等。

应用层 ：为操作系统或网络应用程序提供访问网络服务的接口。

### 2.TCP 三次握手和四次挥手的全过程

(1)TCP的连接(三次握手)

        假设客户端和服务端的进程都处于CLOSED(关闭)状态。客户端主动打开连接，服务端被动打开连接。
        
        TCP服务进程先创建传输控制块TCB，准备接受客户进程的连接请求，然后服务器进程就处于LISTEN(收听)状态，等待客户端的连接请求，如有，即作出响应。
        
        TCP客户进程也是首先创建传输控制块TCB，然后向服务端发送连接请求报文段，这时首部中的同部位SYN=1，同时选择一个初始序列号seq=x。TCP规定，SYN报文段不能携带数据，但要消耗一个序号，这时，TCP客户进程进入SYN-SENT(同步已发送)状态。
        
        TCP客户收到连接请求报文段后，如同意建立连接，则向客户端发送确认。在确认报文段中应把SYN和ACK位都置1，确认号是ack=x+1;同时也为自己选择一个初始序列号seq=y。这个报文段也不携带数据，这时，服务器进程进入SYN-RCVD(同步收到)状态。
        
        TCk客户进程收到服务器进程的确认报文段后，还要向服务器进程发送确认，确认报文段的ACK置1，确认好ack=y+1,自己的序列号seq=x+1，TCP的标准规定，ACK的报文段可以携带数据，但如果不携带数据则不消耗序列号，在这种情况下，下一个数据报文段的序号仍是seq=x+1。这时TCP建立连接，客户端进入ESTABLISHED(已建立连接)状态。
        
        当服务器进程也收到客户端进程的确认信号时，也进入ESTABLISHED状态。
        
![三次握手](./images/三次握手.jpg)

为什么需要三次握手？

        三次握手的目的是“为了防止已经失效的连接请求报文段突然又传到服务端，因而产生错误”，这种情况是：client端发出了一个连接请求报文，而是因为某些未知的原因在某个网络节点上发生延迟、滞留，导致延迟到连接释放以后的某个时间才到达server端。本来这是一个早已失效的报文段，但是server收到此失效的报文之后，会误认为是client再次发出的一个新的连接请求，于是server端就向client又发出确认报文，表示同意建立连接。如果不采用“三次握手”，那么只要server端发出确认报文就会认为新的连接已经建立了，但是client端此时并没有发出建立连接的请求，因此不会去向server端发送数据，server端没有收到数据就会一直等待，产生死锁现象，这样server端就会白白浪费掉很多资源。
        
(2)TCP的连接释放(四次挥手)

        数据传输结束后，双方都可以释放连接。现在客户端和服务器进程都处于ESTABLISHED状态。客户端的进程先向其TCP发出释放报文段，并停止再发送数据，主动关闭TCP连接。客户端进程把连接释放报文段首部的终止控制位FIN置1，其序号seq=u,它等于前面已传送过的的数据的最后一个字节的序号加1。这时客户端进程进入FIN-WAIT-1(终止等待1)状态，等待服务端进程的确认。请注意，TCP规定，FIN报文段即使不携带数据，它也消耗一个序号。
        
        服务端进程收到释放报文段后即发出确认，确认号是ack=u+1，而这个报文段的序号是v,它等于服务端前面已传送的数据的最后一个字节的序号加1。然后服务端进程就进入CLOSE-WAIT(关闭等待)状态。此时的TCP处于半连接(half-close)状态，即客户端已经没有数据发送了，但服务端进程若有数据向客户端发送，客户端仍要接收。
        
        客户端接到到服务端的确认后，就进入FIN-WAIT-2(终止等待2)状态，等到服务端发出连接释放报文段。
        
        如果服务端没有数据要向客户端发送了，这时服务端就发出连接释放报文段，FIN置1，现假定其序号等于w,(在半关闭状态的时候服务端可能又发送一些数据)，服务端还必须重复发送上一次已发送的确认号ack=u+1。这时服务端进程就进入LAST-ACK(最后确认)状态，等待客户端进程的确认。
        
        客户端进进程在收到服务端的连接释放报文段后，必须对此发出确认。在确认报文段中把ACK置1，确认号ack=w+1,而自己的序号seq=u+1，然后进入TIME-WAIT(时间等待)状态。请注意，现在TCP还没有释放掉，必须经过时间等待计时器(TIME-WAIT timer)设置的时间2MSL(MSL是最长报文段寿命)后，客户端才能进入到CLOSED状态。服务端进程只要收到客户端发出的确认，就进入CLOSED状态。
        
![四次挥手](./images/四次挥手.jpg)

为什么客户端进程要在TIME-WAIT状态必须等待2MSL的时间？

1）为了保证客户端发送的最后的一个ACK报文段能够到达服务端。

        这个报文段有可能丢失，因而使处在LAST-ACK状态的服务端进程收不到已发送的FIN+ACK报文段的确认。服务器进程会重新超时重发这个FIN+ACK报文段。接着客户端进程重发一次确认，重新启动2MSL计时器。这样能保证服务端进程能收到确认，才能正常进入CLOSED状态。
        
2）防止"已失效的连接请求报文段"出现在本连接中

        客户端发送最后一个ACK报文段后，再经过时间2MSL，就可以使本连接持续的时间内所产生的所有报文段都从网络中消失。这样就可以使下一个新的连接中不会出现这种旧的连接请求报文段。
        
### 3.get 和 post 的区别？

- GET在浏览器回退时是无害的，而POST会再次提交请求。
- GET产生的URL地址可以被Bookmark，而POST不可以。
- GET请求会被浏览器主动cache，而POST不会，除非手动设置。
- GET请求只能进行url编码，而POST支持多种编码方式。
- GET请求参数会被完整保留在浏览器历史记录里，而POST中的参数不会被保留。
- GET请求在URL中传送的参数是有长度限制的，而POST没有。(大多数浏览器通常都会限制url长度在2K个字节，而大多数服务器最多处理64K大小的url。)
- 对参数的数据类型，GET只接受ASCII字符，而POST没有限制。
- GET比POST更不安全，因为参数直接暴露在URL上，所以不能用来传递敏感信息。
- GET参数通过URL传递，POST放在Request body中。
- GET产生一个TCP数据包；POST产生两个TCP数据包。(对于GET方式的请求，浏览器会把http header和data一并发送出去，服务器响应200（返回数据）；而对于POST，浏览器先发送header，服务器响应100 continue，浏览器再发送data，服务器响应200 ok（返回数据）。)

### 4.cookie 和session的区别？




2.       IP 地址的分类

A类地址：以0开头，第一个字节范围：0~127；

B类地址：以10开头，第一个字节范围：128~191；

C类地址：以110开头，第一个字节范围：192~223；

D类地址：以1110开头，第一个字节范围为224~239；

3.       ARP 协议的工作原理

首先，每台主机都会在自己的ARP缓冲区中建立一个 ARP列表，以表示IP地址和MAC地址的对应关系。当源主机需要将一个数据包要发送到目的主机时，会首先检查自己 ARP列表中是否存在该 IP地址对应的MAC地址，如果有，就直接将数据包发送到这个MAC地址；如果没有，就向本地网段发起一个ARP请求的广播包，查询此目的主机对应的MAC地址。此ARP请求数据包里包括源主机的IP地址、硬件地址、以及目的主机的IP地址。网络中所有的主机收到这个ARP请求后，会检查数据包中的目的IP是否和自己的IP地址一致。如果不相同就忽略此数据包；如果相同，该主机首先将发送端的MAC地址和IP地址添加到自己的ARP列表中，如果ARP表中已经存在该IP的信息，则将其覆盖，然后给源主机发送一个 ARP响应数据包，告诉对方自己是它需要查找的MAC地址；源主机收到这个ARP响应数据包后，将得到的目的主机的IP地址和MAC地址添加到自己的ARP列表中，并利用此信息开始数据的传输。如果源主机一直没有收到ARP响应数据包，表示ARP查询失败。

4.       路由设备与相关层

物理层 ：中继器（Repeater，也叫放大器），集线器。

数据链路层 ：网桥，交换机。

网络层 ：路由器。

网关 ：网络层以上的设备。

5.       常见的路由选择协议，以及它们的区别

常见的路由选择协议有：RIP协议、OSPF协议。

RIP协议 ：底层是贝尔曼福特算法，它选择路由的度量标准（metric)是跳数，最大跳数是15跳，如果大于15跳，它就会丢弃数据包。

OSPF协议 ：底层是迪杰斯特拉算法，是链路状态路由选择协议，它选择路由的度量标准是带宽，延迟。

6.       TCP 与 UDP 的区别

UDP是面向无连接的，不可靠的数据报服务；

TCP是面向连接的，可靠的字节流服务。

7.       TCP 的可靠性如何保证？

TCP的可靠性是通过顺序编号和确认（ACK）来实现的。



 

10.   在浏览器中输入 www.baidu.com 后执行的全部过程

现在假设如果我们在客户端（客户端）浏览器中输入http://www.baidu.com,而baidu.com为要访问的服务器（服务器），下面详细分析客户端为了访问服务器而执行的一系列关于协议的操作：

1、客户端浏览器通过DNS解析到www.baidu.com的IP地址220.181.27.48，通过这个IP地址找到客户端到服务器的路径。客户端浏览器发起一个HTTP会话到220.161.27.48，然后通过TCP进行封装数据包，输入到网络层。

2、在客户端的传输层，把HTTP会话请求分成报文段，添加源和目的端口，如服务器使用80端口监听客户端的请求，客户端由系统随机选择一个端口如5000，与服务器进行交换，服务器把相应的请求返回给客户端的5000端口。然后使用IP层的IP地址查找目的端。

3、客户端的网络层不用关系应用层或者传输层的东西，主要做的是通过查找路由表确定如何到达服务器，期间可能经过多个路由器，这些都是由路由器来完成的工作，我不作过多的描述，无非就是通过查找路由表决定通过那个路径到达服务器。

4、客户端的链路层，包通过链路层发送到路由器，通过邻居协议查找给定IP地址的MAC地址，然后发送ARP请求查找目的地址，如果得到回应后就可以使用ARP的请求应答交换的IP数据包现在就可以传输了，然后发送IP数据包到达服务器的地址。

11.   HTTP 协议包括哪些请求？

GET：请求读取由URL所标志的信息。

POST：给服务器添加信息（如注释）。

PUT：在给定的URL下存储一个文档。

DELETE：删除给定的URL所标志的资源。

12.   HTTP 中， POST 与 GET 的区别

(1)Get是从服务器上获取数据，Post是向服务器传送数据。

(2)Get是把参数数据队列加到提交表单的Action属性所指向的URL中，值和表单内各个字段一一对应，在URL中科院看到。

(3)Get传送的数据量小，不能大于2KB；post传送的数据量较大，一般被默认为不受限制。

(4)根据HTTP规范，GET用于信息获取，而且应该是安全的和幂等的。

I.所谓 安全的 意味着该操作用于获取信息而非修改信息。换句话说，GET 请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。

II. 幂等 的意味着对同一URL的多个请求应该返回同样的结果。

13.   TCP/IP 中，每一层对应的协议

网络层 ：IP协议、ICMP协议、ARP协议、RARP协议。

传输层 ：UDP协议、TCP协议。

应用层 ：FTP（文件传送协议）、Telenet（远程登录协议）、DNS（域名解析协议）、SMTP（邮件传送协议），POP3协议（邮局协议），HTTP协议。

14.   TCP 对应的协议和 UDP 对应的协议

TCP对应的协议：

（1） FTP ：定义了文件传输协议，使用21端口。常说某某计算机开了FTP服务便是启动了文件传输服务。下载文件，上传主页，都要用到FTP服务。

（2） Telnet ：它是一种用于远程登陆的端口，用户可以以自己的身份远程连接到计算机上，通过这种端口可以提供一种基于DOS模式下的通信服务。如以前的BBS是-纯字符界面的，支持BBS的服务器将23端口打开，对外提供服务。

（3） SMTP ：定义了简单邮件传送协议，现在很多邮件服务器都用的是这个协议，用于发送邮件。如常见的免费邮件服务中用的就是这个邮件服务端口，所以在电子邮件设置-中常看到有这么SMTP端口设置这个栏，服务器开放的是25号端口。

（4） POP3 ：它是和SMTP对应，POP3用于接收邮件。通常情况下，POP3协议所用的是110端口。也是说，只要你有相应的使用POP3协议的程序（例如Fo-xmail或Outlook），就可以不以Web方式登陆进邮箱界面，直接用邮件程序就可以收到邮件（如是163邮箱就没有必要先进入网易网站，再进入自己的邮-箱来收信）。

（5）HTTP协议： 是从 Web 服务器传输超文本到本地浏览器的传送协议。

UDP对应的协议：

（1） DNS ：用于域名解析服务，将域名地址转换为IP地址。DNS用的是53号端口。

（2） SNMP ：简单网络管理协议，使用161号端口，是用来管理网络设备的。由于网络设备很多，无连接的服务就体现出其优势。

（3） TFTP (Trival File Transfer Protocal)，简单文件传输协议，该协议在熟知端口69上使用UDP服务。

15.特殊的IP地址

（1）网络地址

IP地址由网络号（包括子网号）和主机号组成，网络地址的主机号为全0，网络地址代表着整个网络。

（2）广播地址

广播地址通常称为直接广播地址，是为了区分受限广播地址。

广播地址与网络地址的主机号正好相反，广播地址中，主机号为全1。当向某个网络的广播地址发送消息时，该网络内的所有主机都能收到该广播消息。

（3）组播地址

D类地址就是组播地址。

先回忆下A，B，C，D类地址吧

A类地址以00开头，第一个字节作为网络号，地址范围为：0.0.0.0~127.255.255.255；

B类地址以10开头，前两个字节作为网络号，地址范围是：128.0.0.0~191.255.255.255;

C类地址以110开头，前三个字节作为网络号，地址范围是：192.0.0.0~223.255.255.255。

D类地址以1110开头，地址范围是224.0.0.0~239.255.255.255，D类地址作为组播地址（一对多的通信）；

E类地址以1111开头，地址范围是240.0.0.0~255.255.255.255，E类地址为保留地址，供以后使用。

Notice：只有A,B,C有网络号和主机号之分，D类地址和E类地址没有划分网络号和主机号。

（4）255.255.255.255

该IP地址指的是受限的广播地址。受限广播地址与一般广播地址（直接广播地址）的区别在于，受限广播地址之只能用于本地网络，路由器不会转发以受限广播地址为目的地址的分组；一般广播地址既可在本地广播，也可跨网段广播。例如：主机192.168.1.1/30上的直接广播数据包后，另外一个网段192.168.1.5/30也能收到该数据报；若发送受限广播数据报，则不能收到。

Notice：一般的广播地址（直接广播地址）能够通过某些路由器（当然不是所有的路由器），而受限的广播地址不能通过路由器。

（5）0.0.0.0

常用于寻找自己的IP地址，例如在我们的RARP，BOOTP和DHCP协议中，若某个未知IP地址的无盘机想要知道自己的IP地址，它就以255.255.255.255为目的地址，向本地范围（具体而言是被各个路由器屏蔽的范围内）的服务器发送IP请求分组。

（6）回环地址

127.0.0.0/8被用作回环地址，回环地址表示本机的地址，常用于对本机的测试，用的最多的是127.0.0.1。

（7）A、B、C类私有地址

私有地址(private address)也叫专用地址，它们不会在全球使用，只具有本地意义。

A类私有地址：10.0.0.0/8，范围是：10.0.0.0~10.255.255.255

B类私有地址：172.16.0.0/12，范围是：172.16.0.0~172.31.255.255

C类私有地址：192.168.0.0/16，范围是：192.168.0.0~192.168.255.255

15.   NAT 协议、 DHCP 协议、 DNS 协议的作用

NAT协议 ：网络地址转换(NAT,Network AddressTranslation)属接入广域网(WAN)技术，

是一种将私有（保留）地址转化为合法IP地址的转换技术，它被广泛应用于各种类型Internet接入方式和各种类型的网络中。原因很简单，NAT不仅完美地解决了lP地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机。

DHCP协议 ：动态主机设置协议（Dynamic Host ConfigurationProtocol, DHCP）

是一个局域网的网络协议，使用UDP协议工作，主要有两个用途：给内部网络或网络服务供应商自动分配IP地址，给用户或者内部网络管理员作为对所有计算机作中央管理的手段。

DNS协议 ：DNS 是域名系统 (Domain Name System) 的缩写，是因特网的一项核心服务，它作为可以将域名和IP地址相互映射的一个分布式数据库，能够使人更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。

